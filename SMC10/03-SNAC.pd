#N canvas 375 144 822 569 10;
#X declare -lib zexy;
#X declare -lib zexy;
#X obj 293 201 bng 25 250 50 0 empty empty empty 17 7 0 10 -262144
-260097 -1;
#X text 279 183 change phases;
#X obj 146 93 vsl 15 100 0 1 0 1 empty empty 1 4 9 0 10 -262144 -260097
-1 1900 0;
#N canvas 658 217 529 406 test-signal-harmonics1234--- 0;
#X obj 88 226 osc~ 100;
#X obj 165 227 osc~ 200;
#X obj 243 226 osc~ 300;
#X obj 88 369 outlet~;
#X msg 45 103 344.531;
#X obj 45 77 loadbang;
#X obj 35 19 inlet;
#X obj 35 145 f;
#X obj 109 22 inlet;
#X text 76 19 freq;
#X text 433 22 random phases;
#N canvas 0 22 359 215 random 0;
#X obj 29 33 inlet;
#X obj 105 72 random 100;
#X obj 190 71 random 100;
#X obj 105 119 / 100;
#X obj 190 117 / 100;
#X obj 29 72 random 100;
#X obj 29 119 / 100;
#X obj 29 159 outlet;
#X obj 105 157 outlet;
#X obj 190 155 outlet;
#X obj 266 71 random 100;
#X obj 266 117 / 100;
#X obj 266 155 outlet;
#X connect 0 0 5 0;
#X connect 0 0 1 0;
#X connect 0 0 2 0;
#X connect 0 0 10 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 8 0;
#X connect 4 0 9 0;
#X connect 5 0 6 0;
#X connect 6 0 7 0;
#X connect 10 0 11 0;
#X connect 11 0 12 0;
#X restore 396 134 pd random;
#X obj 186 20 inlet;
#X obj 264 20 inlet;
#X obj 349 22 inlet;
#X obj 165 266 *~ 1;
#X obj 243 268 *~ 1;
#X obj 88 267 *~ 1;
#X text 152 53 magnitudes;
#X obj 109 79 clip 0 1;
#X obj 186 80 clip 0 1;
#X obj 264 78 clip 0 1;
#X obj 243 189 * 3;
#X obj 328 268 *~ 1;
#X obj 396 21 inlet;
#X obj 328 233 osc~ 400;
#X obj 417 82 loadbang;
#X msg 438 194 0;
#X obj 261 319 block~ 256;
#X obj 88 313 *~ 0.25;
#X obj 183 310 noise~;
#X obj 328 189 * 4;
#X obj 165 191 * 2;
#X connect 0 0 17 0;
#X connect 1 0 15 0;
#X connect 2 0 16 0;
#X connect 4 0 7 0;
#X connect 5 0 4 0;
#X connect 6 0 7 0;
#X connect 7 0 0 0;
#X connect 7 0 22 0;
#X connect 7 0 31 0;
#X connect 7 0 32 0;
#X connect 8 0 19 0;
#X connect 11 0 0 1;
#X connect 11 1 1 1;
#X connect 11 2 2 1;
#X connect 11 3 25 1;
#X connect 12 0 20 0;
#X connect 13 0 21 0;
#X connect 14 0 23 1;
#X connect 15 0 29 0;
#X connect 16 0 29 0;
#X connect 17 0 29 0;
#X connect 19 0 17 1;
#X connect 20 0 15 1;
#X connect 21 0 16 1;
#X connect 22 0 2 0;
#X connect 23 0 29 0;
#X connect 24 0 11 0;
#X connect 25 0 23 0;
#X connect 26 0 11 0;
#X connect 27 0 0 1;
#X connect 27 0 1 1;
#X connect 27 0 2 1;
#X connect 27 0 25 1;
#X connect 29 0 3 0;
#X connect 31 0 25 0;
#X connect 32 0 1 0;
#X restore 110 237 pd test-signal-harmonics1234---;
#X obj 183 93 vsl 15 100 0 1 0 1 empty empty 2 4 9 0 10 -262144 -260097
-1 9900 0;
#X obj 219 93 vsl 15 100 0 1 0 1 empty empty 3 4 9 0 10 -262144 -260097
-1 3600 0;
#X obj 256 93 vsl 15 100 0 1 0 1 empty empty 4 4 9 0 10 -262144 -260097
-1 0 0;
#X text 146 70 harmonic components;
#X floatatom 153 210 4 0 0 0 - - -;
#X floatatom 189 210 4 0 0 0 - - -;
#X floatatom 227 210 4 0 0 0 - - -;
#X floatatom 263 210 4 0 0 0 - - -;
#X obj 113 28 hsl 128 15 80 2000 1 1 empty empty frequency 20 8 0 10
-262144 -260097 -1 5400 0;
#X floatatom 121 53 5 0 0 0 - - -;
#X obj 366 81 cnv 15 400 70 empty empty empty 20 12 0 14 -233017 -66577
0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-signal 1024 float 0;
#X coords 0 1 1023 -1 400 140 1;
#X restore 366 11 graph;
#N canvas 913 32 255 403 autocorrelation 0;
#X obj 18 16 inlet~;
#X obj 18 225 *~;
#X obj 45 225 *~;
#X text 76 223 make power spectrum;
#X obj 33 42 tabreceive~ \$0-zeropad;
#X obj 18 67 *~;
#X obj 18 354 tabwrite~ \$0-correlation;
#X obj 33 324 r \$0-draw;
#X obj 58 125 tabwrite~ \$0-signal;
#X obj 91 99 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 58 76 r \$0-draw;
#X obj 18 190 rfft~;
#X obj 18 260 rifft~;
#X text 51 288 normalisation;
#X text 65 161 normalisation;
#X obj 167 80 block~ 1024;
#X obj 18 161 /~ 32;
#X connect 0 0 5 0;
#X connect 1 0 12 0;
#X connect 2 0 12 0;
#X connect 4 0 5 1;
#X connect 5 0 8 0;
#X connect 5 0 16 0;
#X connect 7 0 6 0;
#X connect 9 0 8 0;
#X connect 10 0 8 0;
#X connect 11 0 1 0;
#X connect 11 0 1 1;
#X connect 11 1 2 0;
#X connect 11 1 2 1;
#X connect 12 0 6 0;
#X connect 16 0 11 0;
#X restore 89 331 pd autocorrelation;
#N canvas 573 420 450 300 zeropad 0;
#X obj 40 117 until;
#X obj 40 173 f;
#X obj 71 173 + 1;
#X obj 40 266 tabwrite \$0-zeropad;
#X obj 40 90 t f b;
#X obj 40 202 t f f;
#X text 102 102 rectangular window;
#X obj 40 34 loadbang;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-zeropad 1024 float 0;
#X coords 0 1.1 1023 -1 200 140 1;
#X restore 226 58 graph;
#X obj 228 255 s \$0-zeropad;
#X msg 228 225 const 0;
#X msg 40 236 1;
#X msg 55 146 0;
#X msg 40 60 512;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 5 0;
#X connect 2 0 1 1;
#X connect 4 0 0 0;
#X connect 4 1 12 0;
#X connect 5 0 11 0;
#X connect 5 1 3 1;
#X connect 7 0 13 0;
#X connect 10 0 9 0;
#X connect 11 0 3 0;
#X connect 12 0 1 1;
#X connect 13 0 4 0;
#X restore 226 412 pd zeropad;
#X obj 365 262 cnv 15 400 70 empty empty empty 20 12 0 14 -233017 -66577
0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-correlation 1024 float 0;
#X coords 0 128 1023 -128 400 140 1;
#X restore 365 192 graph;
#N canvas 0 22 183 168 draw 0;
#X obj 45 102 s \$0-draw;
#X obj 45 27 inlet;
#X obj 45 68 metro 500;
#X connect 1 0 2 0;
#X connect 2 0 0 0;
#X restore -7 150 pd draw;
#X obj -7 115 tgl 25 1 empty empty empty 17 7 0 10 -262144 -1 -1 0
1;
#N canvas 284 140 577 612 SNAC 0;
#N canvas 75 51 324 693 one-coefficient 0;
#X obj 51 559 tabread \$0-correlation;
#X obj 66 243 tabread \$0-signal;
#X obj 183 244 tabread \$0-signal;
#X obj 66 273 t f f;
#X obj 183 272 t f f;
#X obj 66 302 *;
#X obj 183 299 *;
#X obj 66 329 +;
#X obj 51 590 /;
#X obj 66 102 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X floatatom 119 607 10 0 0 0 - - -;
#X obj 66 420 f;
#X obj 66 196 t f f;
#X obj 66 391 +;
#X obj 66 134 t b b;
#X msg 131 374 0;
#X obj 51 456 f;
#X obj 51 505 f 0;
#X obj 51 480 t b f;
#X floatatom 148 522 10 0 0 0 - - -;
#X floatatom 198 85 5 0 0 0 - - -;
#X obj 183 213 +;
#X text 236 86 tau;
#X obj 66 36 inlet;
#X obj 66 68 t b f;
#X obj 51 619 outlet;
#X floatatom 119 585 10 0 0 0 - - -;
#X obj 193 617 outlet;
#X obj 78 505 * 0.5;
#X text 91 621 snac;
#X text 235 619 norm;
#X obj 135 98 t b f;
#X obj 134 142 -;
#X msg 135 121 511;
#X obj 66 169 for++ 0 511;
#X connect 0 0 8 0;
#X connect 0 0 26 0;
#X connect 1 0 3 0;
#X connect 2 0 4 0;
#X connect 3 0 5 0;
#X connect 3 1 5 1;
#X connect 4 0 6 0;
#X connect 4 1 6 1;
#X connect 5 0 7 0;
#X connect 6 0 7 1;
#X connect 7 0 13 0;
#X connect 8 0 25 0;
#X connect 8 0 10 0;
#X connect 9 0 14 0;
#X connect 11 0 13 1;
#X connect 11 0 16 1;
#X connect 12 0 1 0;
#X connect 12 1 21 0;
#X connect 13 0 11 0;
#X connect 14 0 34 0;
#X connect 14 1 15 0;
#X connect 15 0 13 1;
#X connect 16 0 18 0;
#X connect 17 0 0 0;
#X connect 18 0 17 0;
#X connect 18 1 28 0;
#X connect 20 0 21 1;
#X connect 20 0 17 1;
#X connect 21 0 2 0;
#X connect 23 0 24 0;
#X connect 24 0 9 0;
#X connect 24 1 20 0;
#X connect 24 1 31 0;
#X connect 28 0 8 1;
#X connect 28 0 27 0;
#X connect 28 0 19 0;
#X connect 31 0 33 0;
#X connect 31 1 32 1;
#X connect 32 0 34 1;
#X connect 33 0 32 0;
#X connect 34 0 12 0;
#X connect 34 1 16 0;
#X restore 19 155 pd one-coefficient;
#X obj 19 106 t f f;
#X obj 19 210 tabwrite \$0-snac;
#X obj 19 33 r \$0-draw;
#X obj 19 68 for++ 0 512 1;
#X obj 171 29 r \$0-draw;
#X obj 171 63 t b b;
#X obj 187 376 f;
#X obj 338 213 tabread \$0-signal;
#X obj 171 553 tabwrite \$0-snac;
#X obj 171 439 /;
#X obj 338 239 t f f;
#X obj 338 266 *;
#X obj 187 341 +;
#X obj 187 310 * -1;
#X msg 252 311 0;
#X obj 338 133 t b f;
#X obj 338 189 -;
#X msg 338 162 512;
#X obj 150 37 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144 -1
-1;
#X obj 171 145 tabread \$0-correlation;
#X obj 252 335 tabread \$0-correlation;
#X obj 186 406 * 0.5;
#X obj 252 359 * 2;
#X obj 187 199 tabread \$0-signal;
#X obj 187 227 t f f;
#X obj 187 254 *;
#X obj 171 116 t f f f f;
#X obj 187 283 +;
#X text 391 336 init;
#X obj 171 90 for++ 0 511;
#X obj 171 527 clip -1 1;
#X text 31 134 naive method;
#X text 214 284 desintegrate;
#X text 255 30 special normalization;
#X text 256 50 this should really be done with doubles;
#X obj 187 174 - 1;
#X obj 304 453 t b f;
#X msg 304 477 1;
#X obj 304 504 -;
#X obj 304 427 *;
#X msg 319 380 0.2;
#X floatatom 304 530 10 0 0 0 - - -;
#X obj 171 480 * 1;
#X floatatom 329 427 10 0 0 0 - - -;
#X obj 319 403 / 512;
#X obj 319 357 loadbang;
#X text 348 379 bias;
#X obj 479 26 inlet;
#X obj 479 84 clip 0 1;
#X text 443 26 bias;
#X floatatom 479 116 5 0 0 0 - - -;
#X connect 0 0 2 0;
#X connect 1 0 0 0;
#X connect 1 1 2 1;
#X connect 4 0 1 0;
#X connect 5 0 6 0;
#X connect 6 0 30 0;
#X connect 6 1 15 0;
#X connect 7 0 22 0;
#X connect 7 0 13 1;
#X connect 8 0 11 0;
#X connect 10 0 43 0;
#X connect 11 0 12 0;
#X connect 11 1 12 1;
#X connect 12 0 28 1;
#X connect 13 0 7 0;
#X connect 14 0 13 0;
#X connect 15 0 21 0;
#X connect 16 0 18 0;
#X connect 16 1 17 1;
#X connect 17 0 8 0;
#X connect 18 0 17 0;
#X connect 19 0 6 0;
#X connect 20 0 10 0;
#X connect 21 0 23 0;
#X connect 22 0 10 1;
#X connect 23 0 7 0;
#X connect 24 0 25 0;
#X connect 25 0 26 0;
#X connect 25 1 26 1;
#X connect 26 0 28 0;
#X connect 27 0 20 0;
#X connect 27 1 9 1;
#X connect 27 1 40 0;
#X connect 27 2 36 0;
#X connect 27 3 16 0;
#X connect 28 0 14 0;
#X connect 30 0 27 0;
#X connect 31 0 9 0;
#X connect 36 0 24 0;
#X connect 37 0 38 0;
#X connect 37 1 39 1;
#X connect 38 0 39 0;
#X connect 39 0 42 0;
#X connect 39 0 43 1;
#X connect 40 0 37 0;
#X connect 41 0 45 0;
#X connect 43 0 31 0;
#X connect 45 0 40 1;
#X connect 45 0 44 0;
#X connect 46 0 41 0;
#X connect 48 0 49 0;
#X connect 49 0 45 0;
#X connect 49 0 51 0;
#X restore 226 354 pd SNAC;
#X text 508 -8 zero-padded test signal;
#X obj 366 429 cnv 15 400 70 empty empty empty 20 12 0 14 -233017 -66577
0;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-snac 1024 float 0;
#X coords 0 1 1023 -1 400 140 1;
#X restore 366 359 graph;
#X msg 8 412 \; pd dsp 1;
#X obj 8 378 loadbang;
#X obj 73 209 adc~;
#X obj 73 237 +~;
#X text -21 205 soundcard;
#X obj 38 203 vradio 25 1 1 2 empty empty empty 0 -8 0 10 -262144 -260097
-1 1;
#X text -32 230 test signal;
#N canvas 0 22 263 214 filters 0;
#X obj 47 79 hip~ 80;
#X obj 47 41 inlet~;
#X obj 47 176 outlet~;
#X text 103 79 DC filter;
#X text 140 140 sibilant filter;
#X obj 47 140 lp6_cheb~ 1000;
#X obj 125 41 inlet;
#X text 165 40 freq;
#X connect 0 0 5 0;
#X connect 1 0 0 0;
#X connect 5 0 2 0;
#X connect 6 0 5 1;
#X restore 89 300 pd filters;
#X obj 146 274 nbx 4 14 1000 3000 1 1 empty empty empty 0 -8 0 10 -262144
-1 -1 1000 256;
#X text 194 273 lo pass filter freq;
#N canvas 0 22 450 300 (subpatch) 0;
#X array \$0-peaks 1024 float 2;
#X coords 0 1 1024 -1 400 140 1;
#X restore 366 359 graph;
#X msg 9 453 \; pd dsp 0;
#N canvas 90 163 208 279 frequency 0;
#X obj 47 36 inlet;
#X obj 47 166 samplerate~;
#X obj 47 202 /;
#X obj 47 135 t b f;
#X obj 47 71 sel 0 1 2;
#X msg 47 104 256;
#X msg 81 104 128;
#X obj 47 236 outlet;
#X msg 116 105 64;
#X connect 0 0 4 0;
#X connect 1 0 2 0;
#X connect 2 0 7 0;
#X connect 3 0 1 0;
#X connect 3 1 2 1;
#X connect 4 0 5 0;
#X connect 4 1 6 0;
#X connect 4 2 8 0;
#X connect 5 0 3 0;
#X connect 6 0 3 0;
#X connect 8 0 3 0;
#X restore 15 27 pd frequency;
#X obj 15 2 hradio 15 1 0 3 empty empty empty 0 -8 0 10 -262144 -260097
-1 1;
#X floatatom 24 50 5 0 0 0 - - -;
#N canvas 61 75 435 491 peaks 0;
#X obj 76 51 r \$0-draw;
#X obj 78 94 delay 50;
#X obj 133 142 tabplay~ \$0-snac;
#X obj 145 180 delta~;
#X obj 140 216 <~ 0;
#X obj 139 251 delta~;
#X obj 140 299 *~;
#X obj 193 214 clip~ 0 1;
#X obj 140 348 tabwrite~ \$0-peaks;
#X obj 198 252 delay~ 2 2;
#X connect 0 0 1 0;
#X connect 1 0 2 0;
#X connect 1 0 8 0;
#X connect 2 0 3 0;
#X connect 2 0 7 0;
#X connect 3 0 4 0;
#X connect 4 0 5 0;
#X connect 5 0 6 0;
#X connect 6 0 8 0;
#X connect 7 0 9 0;
#X connect 9 0 6 1;
#X restore 226 381 pd peaks;
#X obj 223 438 cnv 15 100 60 empty empty empty 20 12 0 14 -260097 -66577
0;
#N canvas 759 68 442 484 info 0;
#X text 30 62 method invented by Philip McLeod;
#X obj 29 87 pddplink http://miracle.otago.ac.nz/tartini/papers/Philip_McLeod_PhD.pdf
;
#X text 29 16 demo plot of SNAC function: specially normalized autocorrelation
;
#X text 29 127 The SNAC function does not look very stable at first
sight \, but in case of perfect correlation it's period peak is stable
at magnitude 1 An integration process is involved in the normalization
\, which should better be done with double precision floats. Probably
this would improve stability at the right edge of the SNAC output block.
;
#X text 29 227 Notice how SNAC needs little more than one period of
a signal to establish it's periodicity. A very useful aspect for real
time applications. This demo has 512 samples for the input (~86 at
samplerate 44K1).;
#X text 29 360 Katja Vetter Jan 2012;
#X text 29 296 Like regular autocorrelation \, SNAC is prone to octave
errors in the case of weak fundamentals.;
#X obj 29 382 import zexy;
#X restore 246 462 pd info;
#X text 426 342 SNAC: specially normalized autocorrelation;
#X obj 229 309 hsl 100 15 0 1 0 1 empty empty bias 20 8 0 10 -262144
-260097 -1 2000 1;
#X floatatom 234 329 5 0 0 0 - - -;
#X obj 152 -7 import zexy;
#X obj 79 271 multiplex~;
#X connect 0 0 3 5;
#X connect 2 0 3 1;
#X connect 2 0 8 0;
#X connect 3 0 48 1;
#X connect 4 0 3 2;
#X connect 4 0 9 0;
#X connect 5 0 3 3;
#X connect 5 0 10 0;
#X connect 6 0 3 4;
#X connect 6 0 11 0;
#X connect 12 0 3 0;
#X connect 12 0 13 0;
#X connect 21 0 20 0;
#X connect 27 0 26 0;
#X connect 28 0 29 0;
#X connect 28 1 29 1;
#X connect 29 0 48 0;
#X connect 31 0 48 0;
#X connect 33 0 16 0;
#X connect 34 0 33 1;
#X connect 38 0 40 0;
#X connect 38 0 3 0;
#X connect 39 0 38 0;
#X connect 45 0 22 0;
#X connect 45 0 46 0;
#X connect 48 0 33 0;
